<div class="container">
  <form [formGroup]="posForm">
    <div class="container1">
      <div class="col1">
        <ng-container *ngFor="let field of fields">
          <mat-form-field appearance="outline" >
            <mat-label>{{ field.label }}</mat-label>
            
            <ng-container *ngIf="field.label === 'Category'">
              <mat-select formControlName="categoryName" (ngModelChange)="onCategorySelected($event)" >
                <mat-option *ngFor="let category of categories" [value]="category.id">{{ category.categoryName }}</mat-option>
              </mat-select>
            </ng-container>

            <ng-container *ngIf="field.label === 'Product'">
              <mat-select formControlName="product" >
                <mat-option *ngFor="let product of products" [value]="product">
                  {{ product.productName }}
                </mat-option>
              </mat-select>
            </ng-container>
            
            <ng-container *ngIf="field.label === 'Quantity'">
              <input type="number" matInput formControlName="quantity">
            </ng-container>

          </mat-form-field>
        </ng-container>

        <button mat-fab color="success" aria-label="Example icon button with a Add icon"  (click)="addProduct()" >
          <mat-icon>add</mat-icon>
        </button>
      </div>
    </div>
  </form>

   <form [formGroup] = 'totalForm'> 
    <div class="container2">
      <div class="row1">
        <div class="container">

          <table mat-table [dataSource]="salesDataSource" matSort>

            <ng-container matColumnDef="Product">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Product Name </th>
              <td mat-cell *matCellDef="let sale"> {{sale.productName}} </td>
            </ng-container>
          
            <ng-container matColumnDef="Category">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Category </th>
              <td mat-cell *matCellDef="let sale"> {{sale.category}} </td>
            </ng-container>
          
            <ng-container matColumnDef="Quantity">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Quantity </th>
              <td mat-cell *matCellDef="let sale"> {{sale.quantity}} </td>
            </ng-container>

            <ng-container matColumnDef="Price">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Price </th>
              <td mat-cell *matCellDef="let sale "> {{sale.price | currency:'PHP'}} </td>
            </ng-container>
          
            <ng-container matColumnDef="Total">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Total </th>
              <td mat-cell *matCellDef="let sale"> {{sale.total | currency:'PHP'}} </td>
            </ng-container>

            <ng-container matColumnDef="Action">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Actions </th>
              <td mat-cell *matCellDef="let sale let i = index"><button mat-raised-button color="warn" (click)="onDeletedProduct(i)" >Delete</button></td>
            </ng-container>
          
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>

          <mat-paginator #paginator
              [length]="salesDataSource.data.length"
              [pageIndex]="0"
              [pageSize]="10"
              [pageSizeOptions]="[5, 10, 20]"
              showFirstLastButtons
              aria-label="Select page"> 
          </mat-paginator>
        </div>
      </div>
    

      <div class="row2">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Subtotal</mat-label>
          <input matInput formControlName="subTotal" [value]="'₱' + subTotal" (change)="onChange($event)" readonly>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Tax Inclusive</mat-label>
          <input matInput formControlName="taxInclusive"  [value]="taxInclusive" (change)="onChange($event)" readonly>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Tax Amount</mat-label>
          <input matInput formControlName="taxAmount"  [value]="'₱' + taxAmount"  (change)="onChange($event)" readonly>
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Grand Total</mat-label>
          <input matInput formControlName="grandTotal"   [value]="'₱' + grandTotal" (change)="onChange($event)" readonly>
        </mat-form-field>

        <button mat-raised-button class="btn-submit">Check Out</button>
      </div>


    </div>
  </form>
</div>

